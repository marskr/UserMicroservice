# UsersMicroservice 

This is a simple [microservice](https://docs.microsoft.com/pl-pl/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/data-driven-crud-microservice) created for users management.  
Technology: [ASP .NET Core](https://docs.microsoft.com/pl-pl/aspnet/core/?view=aspnetcore-2.1) API with basic CRUD (CRUD for HTTP resources) operations for users and admins.

## Microservice description

This Microservice is responsible for basic Create, Read, Update & Delete operations. In case of making any of mentioned operations safe, autorization management were developed. Additional info:  
* To manage authorization Jason Web Tokens wereincluded. Please check [JWT](https://jwt.io/),
* Any password provided by user is encrypted by the Microservice (RSA algorithm) & inserted into SQL Server Database,
* Salt for encryption is generated by the Microservice & stored in database,
* Any token generated by authorization method is valid for 12 hours.

### Authorization methods

1. Authenticate using _CreateToken_ method by sending email & password. As a result you will obtain token. Any token is valid for 12 hours from now,
2. Check if token is valid using _CheckIfAuthorized_. 

## "Users" http methods

### ShowUser 

**Title :** Show user by email.  
**URL :** /api/Users/:email  
**Method :** GET  
**URL Params :** Required: email = [string]   
**Data Params :**  
{  
  "Email": [String],   
  "Name": [String],  
  "Surname": [String],   
  "PhoneNumber": [Int],  
  "HashPassword": [String],  
  "UserAccountStatus": [String],  
  "AccountStatusChangeDate": [DateTime],  
  "Salt": [String],  
  "AuthToken": [String],   
  "AuthTokenExpiration": [DateTime],  
  "PermissionId": [Int]  
}      
**Response Codes :** Success (200 OK), Not Found (404)  


### AddUser

**Title :** Add new user.  
**URL :** /api/Users  
**Method :** POST  
**URL Params :**  NONE  
**Data Params :**  
{  
  "Email": [String] **Required Unique**,   
  "Name": [String] **Required**,  
  "Surname": [String] **Required**,   
  "PhoneNumber": [Int] **Required**,  
  "HashPassword": [String] **Required**,  
  "UserAccountStatus": [String] **Required**,  
  "AccountStatusChangeDate": [DateTime] **Required**,  
  "Salt": [String] **Required**,  
  "AuthToken": [String] **Non-required**,   
  "AuthTokenExpiration": [DateTime] **Non-required**,  
  "PermissionId": [Int]  **Required**   
}   
**Response Codes :** Success (200 OK), Bad Request (400), Not Found (404)  
**Annotation :** the error 404 will be returned in case of EXISTANCE of user with provided new email!!!  
**Annotation :** Id will be provided automatically by application!  


### UpdateUser

**Title :** Update user.  
**URL :** /api/Users/:email  
**Method :** PUT  
**URL Params :** Required: email = [string]   
**Data Params :**   
{  
  "Email": [String] **Non-required**,   
  "Name": [String] **Required**,  
  "Surname": [String] **Required**,   
  "PhoneNumber": [Int] **Required**,  
  "HashPassword": [String] **Required**,  
  "UserAccountStatus": [String] **Non-required**,  
  "AccountStatusChangeDate": [DateTime] **Non-required**,  
  "Salt": [String] **Non-required**,  
  "AuthToken": [String] **Non-required**,   
  "AuthTokenExpiration": [DateTime] **Non-required**,  
  "PermissionId": [Int] **Non-required**  
}      
**Response Codes :** Success (200 OK), Bad Request (400), Not Found (404)  
**Annotation :** You can update Name, Surname, PhoneNumber & Password!  
**Annotation :** the error 400 will be returned in case of exception!  


### DeleteUser

**Title :** Delete old user.  
**URL :** /api/Users/:email  
**Method :** DELETE  
**URL Params :** Required: email = [string]   
**Data Params :** NONE  
**Response Codes :** Success (200 OK), Bad Request (400), Not Found (404)  
**Annotation :** the error 400 will be returned in case of exception!  


## "Authentication" http methods

### CheckIfAuthorized 

**Title :** Check if provided token is valid.  
**URL :** /api/Authentication/:token  
**Method :** GET  
**URL Params :** Required: token = [string]   
**Data Params :**  NONE  
**Response Body :** TRUE (if token is valid) or FALSE (if not)  
**Response Codes :** Success (200 OK), Not Found (404)  

### CreateToken

**Title :** Create a token using provided email & password. Token value will be returned as result.   
**URL :** /api/Authentication/:email/:password  
**Method :** POST  
**URL Params :** Required: email = [string] and password = [string]  
**Data Params :**  NONE  
**Response Body :** string containing JWF token  
**Response Codes :** Success (200 OK), Bad Request (400), Not Found (404)  
**Annotation :** the error 400 will be returned in case of NULL value of password or email!  
**Annotation :** the error 404 will be returned in case of WRONG value of password or email! 

## Short description of data used by microservice

##### **_Name_** | **_CodeType_** | **_DatabaseType_** | **_Required?_** | **_Example_** : **_Description_**
  
**Email | _String_ | _VARCHAR(30)_ | _YES_ :**   
_Required. An email provided must be unique! Maximum email length is 30._  
 
**Name | _String_ | _VARCHAR(20)_ |  _YES_ :**  
_Required. The maximum length of any name is 20._  

**Surname | _String_ | _VARCHAR(20)_ | _YES_ :**  
_Required. The maximum length of any surname is 20._  

**PhoneNumber | _Integer_ | _INT_ | _YES_ :**  
_Required. The number should be 9 characters long._  

**Password | _String_ | _VARCHAR(MAX)_ | _YES_ :**   
_Required. Given password will be subsequently encrypted by algorithm & stored in database._  

**UserAccountStatus | _String_ | _VARCHAR(30)_ |  _YES_ :**  
_Required. Currently we can distinguish 2 types of UserAccountStatus - "normal" & "premium". Maximum 30 characters long._  

**AccountStatusChangeDate | _DateTime_ | _DATETIME_ | _YES_ :**  
_Required. The date format is YYYY-MM-DD._  

**Salt | _String_ | _VARCHAR(30)_ | _NO_ :**    
_Non required. Created salt by the Microservice will be used to encrypt password._  

**AuthToken | _String_ | _VARCHAR(MAX)_ | _NO_ :**  
_Non required. Token will be generated by the Microservice._  

**AuthTokenExpiration | _DateTime_ | _DATETIME_ | _NO_ :**  
_Non required. Expiration date will be generated in Authentication process._  

**PermissionId | _Integer_ | _INT_ | _YES_ :**  
_Required. For normal user 0, for administrator 1, for application 2._  







  
